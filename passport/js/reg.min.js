device.desktop()&&(location.href="http://passport.tpooo.net/Users/register.html"),$(function(){function e(){var e=$(".reg-send-code"),t=60;e.attr("disabled","disabled").text(t+"秒").addClass("btn-disable");var i=setInterval(function(){t--,e.text(t+"秒"),0===t&&(clearInterval(i),e.removeAttr("disabled").text("获取验证码").removeClass("btn-disable"))},1e3)}function t(){return/^1[3578]\d{9}$/.test($(".reg-mobile").val())?($(".mobile-invalid-tip").addClass("hide"),!0):($(".mobile-invalid-tip").removeClass("hide"),!1)}function i(){return/^\d{6}$/.test($(".reg-verify-code").val())?($(".code-invalid-tip").addClass("hide"),!0):($(".code-invalid-tip").removeClass("hide"),!1)}function a(){var e=$(".reg-nick-name").val().length;return e>=2&&20>=e?($(".nick-name-tip").addClass("hide"),!0):($(".nick-name-tip").removeClass("hide"),!1)}function o(){var e=$(".reg-pwd").val();return/^[a-zA-Z0-9~!@#\$%\^&\*\-_\+=\.]{6,20}$/.test(e)?($(".input-pwd-tip").addClass("hide"),!0):($(".input-pwd-tip").removeClass("hide"),!1)}function r(e,t,i,a){$(".full-layer").show(),$.ajax({url:"http://passport.tpooo.net/uc_client/send.php",type:"POST",dataType:"json",data:{url:e,method:"POST",datas:JSON.stringify(t)}}).done(function(e){$(".full-layer").hide(),1===e.status?i(e):a?a(e):alert(e.message||"未知错误,请稍后再试.")}).fail(function(e){$(".full-layer").hide(),a?a(e):alert("服务器繁忙,请稍后再试.")})}$("#togglePassword").click(function(){var e=$("#password-cont");"password"==e.attr("type")?e.attr("type","text"):e.attr("type","password")}),$(".reg-send-code").click(function(){t()&&r("http://i.tpooo.net/api/wap/sendSms",{mobile:$(".reg-mobile").val(),type:2},function(t){e()})}),$(".reg-check-btn").click(function(){if(t()&&i()){var e=$(".reg-mobile").val(),a=$(".reg-verify-code").val();r("http://i.tpooo.net/api/wap/checkVerify",{mobile:e,type:2,verifyCode:a},function(t){sessionStorage.setItem("regMobile",e),sessionStorage.setItem("regVerifyCode",a),location.href="/m/Users/reg_submit.php"})}}),$(".reg-submit-btn").click(function(){var e=sessionStorage.getItem("regMobile"),t=sessionStorage.getItem("regVerifyCode");return e&&t?void(a()&&o()&&r("http://i.tpooo.net/api/wap/mobileRegister",{mobile:e,verifyCode:t,nick:$(".reg-nick-name").val(),password:$(".reg-pwd").val()},function(e){location.href=e.datas.callback_url})):void alert("手机号或验证码不存在,请重新输入.")})});